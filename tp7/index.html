<html>
<head>
    <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
    <title>NFP121 - TP7</title>
    <style type="text/css">
        body {
            background: #E5DED6;
            background-color: #fff;
            color: #333333;
            font-size: 14px;
            font-family: Verdana, Arial;
        }

        table {
            font-size: 20px;
            border-color: #808080;
            border-style: solid;
            border-width: 1px;
        }

        h2 {
            color: #C1002A;
            font-family: Verdana, Arial;
            font-size: 30px;
            font-weight: bold;
        }

        h3 {
            color: #C1002A;
            font-family: Verdana, Arial;
            font-size: 20px;
            font-weight: bold;
        }
        
        hr {
            margin: 15px 0 15px 0;
        }
		
		applet {
			margin: 10px 0px 25px 250px;
			border-width: 1px;
			border-style: solid;
			border-color: #777777;
		}
    </style>

</head>
<body>
    <h2 style="text-align: center">NFP 121 - TP7</h2>
    <h2 style="text-align: center">Introspection</h2>
    <br />
    <hr>
    <br />
    <table>
        <tr>
            <td>ABOUZEID
            </td>
            <td>...
            </td>
        </tr>
        <tr>
            <td>Benoit
            </td>
            <td>...
            </td>
        </tr>
        <tr>
            <td>Matricule
            </td>
            <td>...
            </td>
        </tr>
    </table>
		
	<br />
    <hr />
    <h3>Question 1</h3>
    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>import</span> java.lang.reflect.Constructor;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.lang.reflect.Method;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.lang.reflect.Parameter;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.ArrayList;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.Arrays;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.Collections;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.HashMap;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.HashSet;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.List;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.Map;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.NoSuchElementException;
<span style='font-weight:bold;color:#7B0052;'>import</span> java.util.Set;

<span style='font-weight:bold;color:#7B0052;'>import</span> com.sun.xml.internal.bind.v2.runtime.unmarshaller.XsiNilLoader.Array;

<span style='color:#3F5FBF'>/**
 * Gestion par introspection des m�thodes de la classe java.lang.Math,&lt;br&gt;
 * Seules sont conserv�es :les m�thodes retournant un double et d'arit� 1 ou 2
 * &lt;p&gt;
 * Note : Emploi du Pattern Singleton pour cette table, accessible uniquement en
 * lecture par des accesseurs
 * &lt;p&gt;
 * La convention de nommage est la suivante : le "Nom" de la fonction suivi de
 * "(double)" exemple : "sqrt(double)" ou le "Nom" de la fonction suivi de
 * "(double, double)" exemple : "IEEEremainder(double, double)"
 */</span>

<span style='font-weight:bold;color:#7B0052;'>final</span> <span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> TableMethodesJavaLangMath <span style='font-weight:bold;color:#D3171B'>{</span>
	<span style='color:#3F5FBF'>/** Singleton */</span>
	<span style='color:#3F7F5F'>//utilisation du patron singleton pour la generation d'une instance unique de TableMethodesJavaLangMath - stateless
</span>	<span style='font-weight:bold;color:#7B0052;'>private</span> <span style='font-weight:bold;color:#7B0052;'>static</span> TableMethodesJavaLangMath instanceUnique = <span style='font-weight:bold;color:#7B0052;'>null</span>;

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> TableMethodesJavaLangMath getInstance() <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>synchronized</span> (TableMethodesJavaLangMath.class) <span style='font-weight:bold;color:#D3171B'>{</span>
			<span style='font-weight:bold;color:#7B0052;'>if</span> (instanceUnique == <span style='font-weight:bold;color:#7B0052;'>null</span>) <span style='font-weight:bold;color:#D3171B'>{</span>
				instanceUnique = <span style='font-weight:bold;color:#7B0052;'>new</span> TableMethodesJavaLangMath();
			<span style='font-weight:bold;color:#D3171B'>}</span>
			<span style='font-weight:bold;color:#7B0052;'>return</span> instanceUnique;
		<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>private</span> TableMethodesJavaLangMath() <span style='font-weight:bold;color:#D3171B'>{</span>
	<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='color:#3F7F5F'>// fin du Singleton
</span>
	<span style='color:#3F5FBF'>/**
	 * @param nomDeLaM�thode Nom de la fonction + "(double)" ou "(double, double)"
	 * @return true si la fonction est pr�sente
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>boolean</span> cetteMethodeEstPresente(String nomDeLaMethode) <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='color:#3F7F5F'>//utilisation de containkey() sur la map afin de verifier la presence de la cle, representant le nom de la methode(String) 
</span>		<span style='font-weight:bold;color:#7B0052;'>if</span> (tableDesMethodes.containsKey(nomDeLaMethode)) <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>true</span>;
		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>else</span> <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>false</span>;

		<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='color:#3F5FBF'>/**
	 * @param nomDeLaM�thode Nom de la fonction + "(double)" ou "(double, double)"
	 * @return true si la fonction est binaire, d'arit� 2
	 * @throws NoSuchElementException si la m�thode demand�e n'existe pas
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>boolean</span> cetteMethodeAttendDeuxParametres(String nomDeLaMethode) <span style='font-weight:bold;color:#D3171B'>{</span>
        
		<span style='color:#3F7F5F'>//on teste si la methode existe
</span>		<span style='font-weight:bold;color:#7B0052;'>if</span> (cetteMethodeEstPresente(nomDeLaMethode)) <span style='font-weight:bold;color:#D3171B'>{</span>
            
			<span style='color:#3F7F5F'>//renvoie la methode (type Method) de la map
</span>			Method method = tableDesMethodes.get(nomDeLaMethode);
            
			<span style='color:#3F7F5F'>//si la methode a 2 parametres (double, double)
</span>			<span style='font-weight:bold;color:#7B0052;'>if</span> (method.getParameterCount() == 2) <span style='font-weight:bold;color:#D3171B'>{</span>

				<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>true</span>;

			<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>else</span> <span style='font-weight:bold;color:#D3171B'>{</span>

				<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>false</span>;
			<span style='font-weight:bold;color:#D3171B'>}</span>
		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>else</span> <span style='font-weight:bold;color:#D3171B'>{</span>
            
			<span style='color:#3F7F5F'>//sinon on throw une NSEE
</span>			<span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> NoSuchElementException();
		<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='color:#3F5FBF'>/**
	 * @param nomDeLaM�thode Nom de la fonction + "(double)" ou "(double, double)"
	 * @return true si la fonction est unaire, d'arit� 1
	 * @throws NoSuchElementException si la m�thode demand�e n'existe pas
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>boolean</span> cetteMethodeAttendUnSeulParametre(String nomDeLaMethode) <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='font-weight:bold;color:#7B0052;'>if</span> (cetteMethodeEstPresente(nomDeLaMethode)) <span style='font-weight:bold;color:#D3171B'>{</span>

			Method method = tableDesMethodes.get(nomDeLaMethode);
			
			<span style='color:#3F7F5F'>//si la methode a 1 parametre (double)
</span>			<span style='font-weight:bold;color:#7B0052;'>if</span> (method.getParameterCount() == 1) <span style='font-weight:bold;color:#D3171B'>{</span>

				<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>true</span>;

			<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>else</span> <span style='font-weight:bold;color:#D3171B'>{</span>

				<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>false</span>;
			<span style='font-weight:bold;color:#D3171B'>}</span>
		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>else</span> <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> NoSuchElementException();
		<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='color:#3F5FBF'>/**
	 * Obtention de la liste ordonn�e des m�thodes
	 * 
	 * @return la liste tri�e des fonctions issues de java.lang.Math
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> String[] listeDesMethodes() <span style='font-weight:bold;color:#D3171B'>{</span>
         
		<span style='color:#3F7F5F'>//recuperation du descripteur de classe de java.lang.Maths
</span>		Class&lt;?&gt; classMaths = Math.class;

		List&lt;String&gt; tabMethods = <span style='font-weight:bold;color:#7B0052;'>new</span> ArrayList&lt;&gt;();

		<span style='color:#3F7F5F'>//iteration sur l'ensemble des methodes de la classe Math
</span>		<span style='font-weight:bold;color:#7B0052;'>for</span> (Method method : classMaths.getMethods()) <span style='font-weight:bold;color:#D3171B'>{</span>
             
			<span style='color:#3F7F5F'>//prise en compte de ce que j'estime etre une difference de version du JDK entre mon poste et le serveur Jnews
</span>			<span style='font-weight:bold;color:#7B0052;'>if</span> (!method.getName().contains(<span style='color:#2A00FF'>"fma"</span>)) <span style='font-weight:bold;color:#D3171B'>{</span>

				<span style='color:#3F7F5F'>//recuperation du type des parametres de la methode
</span>				Class&lt;?&gt;[] parametres = method.getParameterTypes();
				
                <span style='color:#3F7F5F'>//verification de la pluralité des parametres, que ces derniers soient du type "double" et que le type de retour soit "double" egalement
</span>				<span style='font-weight:bold;color:#7B0052;'>if</span> (method.getParameterCount() &gt; 0 && method.getReturnType().getName() == <span style='color:#2A00FF'>"double"</span>) <span style='font-weight:bold;color:#D3171B'>{</span>

					<span style='font-weight:bold;color:#7B0052;'>if</span> (parametres[0].getName() == <span style='color:#2A00FF'>"double"</span>) <span style='font-weight:bold;color:#D3171B'>{</span>

						<span style='font-weight:bold;color:#7B0052;'>if</span> (method.getParameterCount() == 1) <span style='font-weight:bold;color:#D3171B'>{</span>

							String methodName = method.getName() + <span style='color:#2A00FF'>"("</span>;

							methodName += parametres[0].getName() + <span style='color:#2A00FF'>")"</span>;

							tabMethods.add(methodName);

							System.out.println(methodName);

						<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>else</span> <span style='font-weight:bold;color:#D3171B'>{</span>

							<span style='font-weight:bold;color:#7B0052;'>if</span> (parametres[0].getName() == <span style='color:#2A00FF'>"double"</span> && parametres[1].getName() == <span style='color:#2A00FF'>"double"</span>) <span style='font-weight:bold;color:#D3171B'>{</span>

								String methodName = method.getName() + <span style='color:#2A00FF'>"("</span>;

								methodName += parametres[0].getName() + <span style='color:#2A00FF'>", "</span> + parametres[1].getName() + <span style='color:#2A00FF'>")"</span>;

								tabMethods.add(methodName);

								System.out.println(methodName);
							<span style='font-weight:bold;color:#D3171B'>}</span>
						<span style='font-weight:bold;color:#D3171B'>}</span>
					<span style='font-weight:bold;color:#D3171B'>}</span>
				<span style='font-weight:bold;color:#D3171B'>}</span>
			<span style='font-weight:bold;color:#D3171B'>}</span>
		<span style='font-weight:bold;color:#D3171B'>}</span>

        <span style='color:#3F7F5F'>//trie du tableau
</span>		Collections.sort(tabMethods);

		<span style='color:#3F7F5F'>//fonctionnel pour conversion en tableau
</span>		String[] strings = tabMethods.stream().toArray(String[]::new);

		<span style='font-weight:bold;color:#7B0052;'>return</span> strings;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='color:#3F5FBF'>/**
	 * Invocation d'une m�thode de la table
	 * 
	 * @param nomDeLaM�thode Nom de la fonction + "(double)"
	 * @param arg1           l'op�rande
	 * @return un r�sultat
	 * @throws NoSuchElementException si la m�thode demand�e n'existe pas ou une
	 *                                exception lev�e par la fonction appel�e
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>double</span> invoquer(String nomDeLaMethode, <span style='font-weight:bold;color:#7B0052;'>double</span> arg1) <span style='font-weight:bold;color:#7B0052;'>throws</span> Exception <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='font-weight:bold;color:#7B0052;'>double</span> res;

		<span style='font-weight:bold;color:#7B0052;'>try</span> <span style='font-weight:bold;color:#D3171B'>{</span>

			Method fonction = tableDesMethodes.get(nomDeLaMethode);
            
			<span style='color:#3F7F5F'>//cast en (double)
</span>			<span style='color:#3F7F5F'>//la methode invoke prend "null" en parametre car methode static
</span>			res = (<span style='font-weight:bold;color:#7B0052;'>double</span>) fonction.invoke(null, arg1);

		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>catch</span> (Exception e) <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> NoSuchElementException();
		<span style='font-weight:bold;color:#D3171B'>}</span>

		<span style='font-weight:bold;color:#7B0052;'>return</span> res;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='color:#3F5FBF'>/**
	 * Invocation d'une m�thode de la table
	 * 
	 * @param nomDeLaM�thode Nom de la fonction + "(double, double)"
	 * @param arg1           l'op�rande
	 * @return un r�sultat
	 * @throws NoSuchElementException si la m�thode demand�e n'existe pas ou une
	 *                                exception lev�e par la fonction appel�e
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>double</span> invoquer(String nomDeLaMethode, <span style='font-weight:bold;color:#7B0052;'>double</span> arg1, <span style='font-weight:bold;color:#7B0052;'>double</span> arg2) <span style='font-weight:bold;color:#7B0052;'>throws</span> Exception <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='font-weight:bold;color:#7B0052;'>double</span> res;

		<span style='font-weight:bold;color:#7B0052;'>try</span> <span style='font-weight:bold;color:#D3171B'>{</span>

			Method fonction = tableDesMethodes.get(nomDeLaMethode);

			Object[] args = <span style='font-weight:bold;color:#7B0052;'>new</span> Object[] <span style='font-weight:bold;color:#D3171B'>{</span> arg1, arg2 <span style='font-weight:bold;color:#D3171B'>}</span>;

			res = (<span style='font-weight:bold;color:#7B0052;'>double</span>) fonction.invoke(null, args);

		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>catch</span> (Exception e) <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> NoSuchElementException();
		<span style='font-weight:bold;color:#D3171B'>}</span>

		<span style='font-weight:bold;color:#7B0052;'>return</span> res;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='color:#3F5FBF'>/**
	 * Le dictionnaire contient la liste des m�thodes disponibles. un choix de
	 * dictionnaire pourrait �tre pour la Cl� une String soit le Nom de la fonction
	 * + "(double)" ou "(double, double)".&lt;br&gt;
	 * et en Valeur = la Method correspondante. ou tout autre choix
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>private</span> <span style='font-weight:bold;color:#7B0052;'>static</span> Map&lt;String, Method&gt; tableDesMethodes = <span style='font-weight:bold;color:#7B0052;'>new</span> HashMap&lt;&gt;();

	<span style='color:#3F5FBF'>/** bloc statique d'intialisation de la table des m�thodes */</span>
	<span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#D3171B'>{</span>
         
		<span style='color:#3F7F5F'>//methode naive, on aurait pu se servir de listeDesMethodes()
</span>		Class&lt;?&gt; classMaths = Math.class;

		<span style='font-weight:bold;color:#7B0052;'>for</span> (Method method : classMaths.getMethods()) <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>if</span> (!method.getName().contains(<span style='color:#2A00FF'>"fma"</span>)) <span style='font-weight:bold;color:#D3171B'>{</span>

				Class&lt;?&gt;[] parametres = method.getParameterTypes();

				<span style='font-weight:bold;color:#7B0052;'>if</span> (method.getParameterCount() &gt; 0 && method.getReturnType().getName() == <span style='color:#2A00FF'>"double"</span>) <span style='font-weight:bold;color:#D3171B'>{</span>

					<span style='font-weight:bold;color:#7B0052;'>if</span> (parametres[0].getName() == <span style='color:#2A00FF'>"double"</span>) <span style='font-weight:bold;color:#D3171B'>{</span>

						<span style='font-weight:bold;color:#7B0052;'>if</span> (method.getParameterCount() == 1) <span style='font-weight:bold;color:#D3171B'>{</span>

							String methodName = method.getName() + <span style='color:#2A00FF'>"("</span>;

							methodName += parametres[0].getName() + <span style='color:#2A00FF'>")"</span>;
                              
							<span style='color:#3F7F5F'>//utilisation de la methode put pour inserer la cle/valeur
</span>							tableDesMethodes.put(methodName, method);

						<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>else</span> <span style='font-weight:bold;color:#D3171B'>{</span>

							<span style='font-weight:bold;color:#7B0052;'>if</span> (parametres[0].getName() == <span style='color:#2A00FF'>"double"</span> && parametres[1].getName() == <span style='color:#2A00FF'>"double"</span>) <span style='font-weight:bold;color:#D3171B'>{</span>

								String methodName = method.getName() + <span style='color:#2A00FF'>"("</span>;

								methodName += parametres[0].getName() + <span style='color:#2A00FF'>", "</span> + parametres[1].getName() + <span style='color:#2A00FF'>")"</span>;

								tableDesMethodes.put(methodName, method);
							<span style='font-weight:bold;color:#D3171B'>}</span>

						<span style='font-weight:bold;color:#D3171B'>}</span>

					<span style='font-weight:bold;color:#D3171B'>}</span>

				<span style='font-weight:bold;color:#D3171B'>}</span>

			<span style='font-weight:bold;color:#D3171B'>}</span>

		<span style='font-weight:bold;color:#D3171B'>}</span>
		
	<span style='font-weight:bold;color:#D3171B'>}</span>

<span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <hr />
    <h3>Question 2.1</h3>
   <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='color:#3F5FBF'>/**
	 * Cette methode permet de relier par introspection, un observable et un observateur
	 * 
	 * Appel par introspection de la methode observable.addObserver(observer)
	 *
	 * @param observable une instance de la classe java.util.Observable ou l'une de ses derivees
	 * @param observer une implementation de l'interface java.util.Observer
	 * @throws NoSuchElementException en cas d'erreur
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>void</span> lierObservableEtObserver(Object observable, Object observer) <span style='font-weight:bold;color:#7B0052;'>throws</span> Exception <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='font-weight:bold;color:#7B0052;'>try</span> <span style='font-weight:bold;color:#D3171B'>{</span>

			Class&lt;?&gt; observableClass = observable.getClass();

			Class&lt;?&gt; observerClass = observer.getClass();
			
            <span style='color:#3F7F5F'>//recuperation du descripteur de class de l'interface de l'observer (Observer)
</span>			Class&lt;?&gt; interfaceObserver = observerClass.getInterfaces()[0];
            
			<span style='color:#3F7F5F'>//car l'interface est le parametre de la methode addObserver
</span>			Method addObserver = observableClass.getMethod(<span style='color:#2A00FF'>"addObserver"</span>, interfaceObserver);

            <span style='color:#3F7F5F'>//liaison de observable/observateur
</span>			addObserver.invoke(observable, observer);

		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>catch</span> (Exception e) <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> NoSuchElementException();
		<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='color:#3F5FBF'>/**
	 * Cette methode permet de delier par introspection, un observable et un
	 * observateur
	 * &lt;p&gt;
	 * Appel par introspection de la methode observable.deleteObserver(observer)
	 * 
	 * @param observable une instance de la classe java.util.Observable ou l'une de
	 *                   ses derivees
	 * @param observer   une implementation de l'interface java.util.Observer
	 * @throws NoSuchElementException en cas d'erreur
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>void</span> delierObservableEtObserver(Object observable, Object observer) <span style='font-weight:bold;color:#7B0052;'>throws</span> Exception <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='font-weight:bold;color:#7B0052;'>try</span> <span style='font-weight:bold;color:#D3171B'>{</span>

			Class&lt;?&gt; observableClass = observable.getClass();

			Class&lt;?&gt; observerClass = observer.getClass();

			Class&lt;?&gt; interfaceObserver = observerClass.getInterfaces()[0];

			Method deleteObserver = observableClass.getMethod(<span style='color:#2A00FF'>"deleteObserver"</span>, interfaceObserver);

			deleteObserver.invoke(observable, observer);

		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>catch</span> (Exception e) <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> NoSuchElementException();
		<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <hr />
    <h3>Question 2.2</h3>
   <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='color:#3F5FBF'>/**
	 * Cette methode permet de relier par introspection, une source et un "listener"
	 * &lt;p&gt;
	 * Appel par introspection de la methode source.addXXXXListener(listener)
	 * 
	 * @param source est une instance
	 * @param listener une implementation d'une interface XXXXListener
	 * @throws NoSuchElementException en cas d'erreur
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>void</span> lierSourceEtListener(Object source, Object listener) <span style='font-weight:bold;color:#7B0052;'>throws</span> Exception <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='font-weight:bold;color:#7B0052;'>try</span> <span style='font-weight:bold;color:#D3171B'>{</span>

			Class&lt;?&gt; sourceClass = source.getClass();

			Class&lt;?&gt; listenerClass = listener.getClass();

			Class&lt;?&gt; interfaceListener = listenerClass.getInterfaces()[0];
            <span style='color:#3F7F5F'>//construction de la chaine de caractere representant la methode d'ajout de l'observateur en fonction de l'interface implementee
</span>			StringBuilder stringBuff = <span style='font-weight:bold;color:#7B0052;'>new</span> StringBuilder(<span style='color:#2A00FF'>"add"</span>);

			String methodName = interfaceListener.getName();
            
			<span style='color:#3F7F5F'>//decoupage en tableau pour avoir le dernier element du package
</span>			String[] methodNameTab = methodName.split(<span style='color:#2A00FF'>"\\."</span>);

			methodName = methodNameTab[methodNameTab.length - 1];
            
			<span style='color:#3F7F5F'>//constitution de la methode adequate
</span>			methodName = stringBuff.append(methodName).toString();

			Method addXXXXListener = sourceClass.getMethod(methodName, interfaceListener);

			<span style='color:#3F7F5F'>//liaison du source/listener
</span>			addXXXXListener.invoke(source, listener);

		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>catch</span> (Exception e) <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> NoSuchElementException();
		<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='color:#3F5FBF'>/**
	 * Cette methode permet de delier par introspection, une source et un "listener"
	 * 
	 * Appel par introspection de la methode source.removeXXXXListener(listener)
	 * 
	 * @param source est une instance
	 * @param listener une implementation d'une interface XXXXListener
	 * @throws NoSuchElementException en cas d'erreur
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>void</span> delierSourceEtListener(Object source, Object listener) <span style='font-weight:bold;color:#7B0052;'>throws</span> Exception <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='font-weight:bold;color:#7B0052;'>try</span> <span style='font-weight:bold;color:#D3171B'>{</span>

			Class&lt;?&gt; sourceClass = source.getClass();

			Class&lt;?&gt; listenerClass = listener.getClass();

			Class&lt;?&gt; interfaceListener = listenerClass.getInterfaces()[0];

			StringBuilder stringBuff = <span style='font-weight:bold;color:#7B0052;'>new</span> StringBuilder(<span style='color:#2A00FF'>"remove"</span>);

			String methodName = interfaceListener.getName();

			String[] methodNameTab = methodName.split(<span style='color:#2A00FF'>"\\."</span>);

			methodName = methodNameTab[methodNameTab.length - 1];

			methodName = stringBuff.append(methodName).toString();

			Method removeXXXXListener = sourceClass.getMethod(methodName, interfaceListener);

			removeXXXXListener.invoke(source, listener);

		<span style='font-weight:bold;color:#D3171B'>}</span> <span style='font-weight:bold;color:#7B0052;'>catch</span> (Exception e) <span style='font-weight:bold;color:#D3171B'>{</span>

			<span style='font-weight:bold;color:#7B0052;'>throw</span> <span style='font-weight:bold;color:#7B0052;'>new</span> NoSuchElementException();
		<span style='font-weight:bold;color:#D3171B'>}</span>
	<span style='font-weight:bold;color:#D3171B'>}</span>
<span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <hr />
    <h3>Question 3</h3>
    <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>class</span> Introspection <span style='font-weight:bold;color:#D3171B'>{</span>

	<span style='color:#3F5FBF'>/**
	 * Malgres 2 methodes: une en parcourant l'arbre d'heritage et une inspiree de l'ED, impossible de passer les tests Jnews
	 * 
	 * 
	 */</span>
	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> Set&lt;Method&gt; getHeritees(String nomDeLaClasse) <span style='font-weight:bold;color:#7B0052;'>throws</span> ClassNotFoundException <span style='font-weight:bold;color:#D3171B'>{</span>
		
<span style='color:#3F7F5F'>/*
		Set&lt;Method&gt; setMethodes = new HashSet&lt;&gt;();

		Class&lt;?&gt; enfant = Class.forName(nomDeLaClasse);

		Method[] methodesEnfant = enfant.getDeclaredMethods();

		for (Method methodEnfant : methodesEnfant) {

			Class&lt;?&gt; parent = enfant.getSuperclass();

			while (parent != null) {

				Method[] methodesParent = parent.getDeclaredMethods();

				for (Method methodParent : methodesParent) {

					if (methodParent.getName() != methodEnfant.getName()
							&& (methodParent.getModifiers() == Modifier.PUBLIC)) {

						setMethodes.add(methodParent);

						System.out.println(methodParent.getName());
					}
				}

				parent = parent.getSuperclass();
			}

		}

		return setMethodes;
	}
*/</span>
	Class&lt;?&gt; classe = Class.forName(nomDeLaClasse);

	<span style='color:#3F7F5F'>//recuperation des methodes heritees
</span>	List&lt;Method&gt; listHeritee = obtenirLesMethodesPubliquesLocalesEtHeritees(classe);

	<span style='color:#3F7F5F'>//la liste est modifiable
</span>	List&lt;Method&gt; methodHeritee = <span style='font-weight:bold;color:#7B0052;'>new</span> ArrayList&lt;&gt;(listHeritee);
    
	<span style='color:#3F7F5F'>//recuperation des methodes redefinies
</span>	List&lt;Method&gt; listOverriden = obtenirLesMethodesPubliquesRedefiniesLocalement(classe);

	List&lt;Method&gt; methodOverriden = <span style='font-weight:bold;color:#7B0052;'>new</span> ArrayList&lt;&gt;(listOverriden);

	Set&lt;Method&gt; methodNotOverriden = <span style='font-weight:bold;color:#7B0052;'>new</span> HashSet&lt;&gt;();

	<span style='color:#3F7F5F'>//On supprime des methodes heritee, celles qui sont redefinies. Obtention des methodes heritees non redefinies???
</span>	methodHeritee.removeAll(methodOverriden);

	<span style='font-weight:bold;color:#7B0052;'>for</span>(
	Method method:methodHeritee)
	<span style='font-weight:bold;color:#D3171B'>{</span>

		methodNotOverriden.add(method);
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>return</span> methodNotOverriden;

	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> List&lt;Method&gt; obtenirLesMethodesPubliquesLocalesEtHeritees(Class&lt;?&gt; cl) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> Arrays.asList(cl.getMethods());
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> List&lt;Method&gt; obtenirToutesLesMethodesAccessiblesDeCetteClasse(Class&lt;?&gt; cl) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> Arrays.asList(cl.getDeclaredMethods());
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> List&lt;Method&gt; obtenirLesMethodesPubliquesRedefiniesLocalement(Class&lt;?&gt; cl) <span style='font-weight:bold;color:#D3171B'>{</span>
		List&lt;Method&gt; listLocalMethods = obtenirToutesLesMethodesAccessiblesDeCetteClasse(cl);
		List&lt;Method&gt; listMethodsSuper = obtenirLesMethodesPubliquesLocalesEtHeritees(cl.getSuperclass());
		List&lt;Method&gt; listMethodsOverride = <span style='font-weight:bold;color:#7B0052;'>new</span> ArrayList&lt;&gt;();
		<span style='font-weight:bold;color:#7B0052;'>for</span> (Method m : listLocalMethods) <span style='font-weight:bold;color:#D3171B'>{</span>
			<span style='font-weight:bold;color:#7B0052;'>if</span> (m.getModifiers() == Modifier.PUBLIC) <span style='font-weight:bold;color:#D3171B'>{</span>

				<span style='font-weight:bold;color:#7B0052;'>if</span> (contient(listMethodsSuper, m)) <span style='font-weight:bold;color:#D3171B'>{</span>

					listMethodsOverride.add(m);
				<span style='font-weight:bold;color:#D3171B'>}</span>
			<span style='font-weight:bold;color:#D3171B'>}</span>
		<span style='font-weight:bold;color:#D3171B'>}</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> listMethodsOverride;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>private</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>boolean</span> contient(List&lt;Method&gt; list, Method m) <span style='font-weight:bold;color:#D3171B'>{</span>
		<span style='font-weight:bold;color:#7B0052;'>for</span> (Method ms : list) <span style='font-weight:bold;color:#D3171B'>{</span>
			<span style='font-weight:bold;color:#7B0052;'>if</span> ((ms.getName().equals(m.getName())) && sameParameterType(ms, m) && sameReturnTypeWithCovariance(ms, m))
				<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>true</span>;
		<span style='font-weight:bold;color:#D3171B'>}</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>false</span>;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>private</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>boolean</span> sameParameterType(Method me, Method m) <span style='font-weight:bold;color:#D3171B'>{</span>
		Class&lt;?&gt;[] paramsMe = me.getParameterTypes();
		Class&lt;?&gt;[] paramsM = m.getParameterTypes();
		<span style='font-weight:bold;color:#7B0052;'>if</span> (paramsMe.length != paramsM.length)
			<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>false</span>;
		<span style='font-weight:bold;color:#7B0052;'>for</span> (<span style='font-weight:bold;color:#7B0052;'>int</span> i = 0; i &lt; paramsMe.length; i++) <span style='font-weight:bold;color:#D3171B'>{</span>
			<span style='font-weight:bold;color:#7B0052;'>if</span> (paramsMe[i] != paramsM[i])
				<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>false</span>;
		<span style='font-weight:bold;color:#D3171B'>}</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>true</span>;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>private</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>boolean</span> sameReturnTypeWithCovariance(Method ms, Method m) <span style='font-weight:bold;color:#D3171B'>{</span>
		Class&lt;?&gt; cl = m.getReturnType();
		Class&lt;?&gt; superCl = ms.getReturnType();
		<span style='font-weight:bold;color:#7B0052;'>if</span> (superCl == cl)
			<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>true</span>;
		<span style='font-weight:bold;color:#7B0052;'>while</span> (cl != <span style='font-weight:bold;color:#7B0052;'>null</span>) <span style='font-weight:bold;color:#D3171B'>{</span>
			cl = cl.getSuperclass();
			<span style='font-weight:bold;color:#7B0052;'>if</span> (superCl == cl)
				<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>true</span>;
		<span style='font-weight:bold;color:#D3171B'>}</span>
		<span style='font-weight:bold;color:#7B0052;'>return</span> <span style='font-weight:bold;color:#7B0052;'>false</span>;
	<span style='font-weight:bold;color:#D3171B'>}</span>

	<span style='font-weight:bold;color:#7B0052;'>public</span> <span style='font-weight:bold;color:#7B0052;'>static</span> <span style='font-weight:bold;color:#7B0052;'>void</span> main(String[] args) <span style='font-weight:bold;color:#7B0052;'>throws</span> ClassNotFoundException <span style='font-weight:bold;color:#D3171B'>{</span>

		<span style='font-weight:bold;color:#7B0052;'>for</span> (Method m : Introspection.getHeritees(<span style='color:#2A00FF'>"java.util.Vector"</span>)) <span style='font-weight:bold;color:#D3171B'>{</span>
			System.out.println(m);
		<span style='font-weight:bold;color:#D3171B'>}</span>

		System.out.println(Introspection.getHeritees(<span style='color:#2A00FF'>"java.util.Vector"</span>).size());
	<span style='font-weight:bold;color:#D3171B'>}</span>

<span style='font-weight:bold;color:#D3171B'>}</span></pre>

    <br />
    <hr />    
        <h3>Conclusion, biliographie et remarques :</h3>
        <i style="font-size:12px;">... Une seule page html, limitez le nombre de clics, (plus de 200 rapports � corriger chaque semaine)</i>
        <pre style='text-align: left; border: 1px dashed #008DEF; line-height: 18px; padding: 15px; font-size: 13px; font-family:'Courier New', Courier, monospace; overflow: auto;'><span style='color:#3F5FBF'>/**
 * Bibliographie: Oracle, NFP121, StackOverFlow...
 */</span></pre>
</body>
</html>
